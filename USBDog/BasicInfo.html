<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>获取锁ID</title>
    <script type="text/javascript">
        function getId() {
            var dog;
            //创建插件或控件
            if (navigator.userAgent.indexOf("MSIE") > 0 && !navigator.userAgent.indexOf("opera") > -1) {
                dog = new ActiveXObject("Syunew3A.s_simnew3");
            }
            else {
                dog = document.getElementById("s_simnew31");
            }

            //查找是否存在锁,这里使用了FindPort函数
            var devicePath = s_simnew31.FindPort(0);
            if (dog.LastError != 0) {
                window.alert("未发现加密锁，请插入加密锁");
                return;
            }

            var id_01 = dog.GetID_1(devicePath);  // 前4个字节
            var id_02 = dog.GetID_2(devicePath);  // 后4个字节

            alert(id_01);
            alert(id_02);
        }
    </script>
</head>
<body>
    <embed id="s_simnew31"  type="application/npsyunew3-plugin" hidden="true" />
    <input type="button" value="GetId" onclick="getId()" />
</body>
</html>
