<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title> Start Lodop </title>
    <script src="/Scripts/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script  src="LodopFuncs.js" type="text/javascript"></script>
    <object  id="LODOP_OB" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width="0" height="0"> 
        <embed id="LODOP_EM" type="application/x-print-lodop" width="0" height="0"></embed>
    </object>
    <style type="text/css">
        div.main
        {
            padding:20px;
        }        
    </style>
</head>
<body>

    <div class="main">
        <input type="button" value="打印名片 自定义" id="button_print_cart" />
        <input type="button" value="打印名片 Table" id="button_print_table" />
        <textarea rows="15" id="textarea01" cols="102">
        <table  style="border-collapse:collapse;border: 1px solid red; width:360px; height:220px;" >
          <tr>
            <td width="100%" height="240">
              <p align="center"> 
              <font face="隶书" size="5">郭德强</font>
              <p align="center"><font face="宋体" size="3">科学家</font></p>
              <p align="left"><font face="宋体" size="3">　地址：中国北京社会科学院附近东大街西胡同</font></p>
              <p align="left"><font face="宋体" size="3">　电话：010-88811888</font></p>
              <p><br>      　
              </p>
            </td>
          </tr>
        </table>
        </textarea>  

    </div>

    <script language="javascript" type="text/javascript">

        // 自定义函数

        // 页面加载时执行
        $(function () {
            // check or create the lodop global Object
            LODOP = getLodop(document.getElementById('LODOP_OB'), document.getElementById('LODOP_EM'));
        });

        // 事件绑定
        $(function () {
            $("#button_print_cart").bind("click", function () {
                LODOP.PRINT_INIT("打印控件功能演示_Lodop功能_名片");

                //增加矩形线
                //ADD_PRINT_RECT(Top, Left, Width, Height, intLineStyle, intLineWidth)
                LODOP.ADD_PRINT_RECT(10, 55, 360, 220, 0, 1);
                LODOP.SET_PRINT_STYLE("FontSize", 11);

                //名称：增加纯文本打印项
                //格式：ADD_PRINT_TEXT(Top, Left, Width, Height, strContent)
                LODOP.ADD_PRINT_TEXT(20, 180, 100, 25, "郭德强");
                //LODOP.SET_PRINT_STYLEA(2, "FontName", "隶书");
                //LODOP.SET_PRINT_STYLEA(2, "FontSize", 15);
                LODOP.ADD_PRINT_TEXT(53, 187, 75, 20, "科学家");
                LODOP.ADD_PRINT_TEXT(100, 131, 272, 20, "地址：中国北京社会科学院附近东大街西胡同");
                LODOP.ADD_PRINT_TEXT(138, 132, 166, 20, "电话：010-88811888");
                
                //ADD_PRINT_BARCODE(Top, Left, Width, Height, CodeType, CodeValue)
                LODOP.ADD_PRINT_BARCODE(160, 34, 360, 36, "EAN128A", "123456789012");
                // 不显示条码文字
                // 第一个参数 0->
                //数字型时，表示是序号，以其增加的先后自然顺序为准，
                //从1开始，所有打印对象都参与排序，包括超文本、纯文本、图片、图线、图表、条码等
                //如果序号为0，代表当前（最后加入的那个）数据项

                // 第三个参数 0->不显示，1->显示
                LODOP.SET_PRINT_STYLEA(0, "ShowBarText", 1);

                LODOP.PRINT();
            });

            $("#button_print_table").bind("click", function () {
                LODOP.PRINT_INIT("");
                LODOP.ADD_PRINT_HTM(10, 55, "100%", "100%", document.getElementById("textarea01").value);
                LODOP.PRINT();
            });

        });

    </script>

</body>
</html>
